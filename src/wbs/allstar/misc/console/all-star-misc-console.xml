<console-module
	name="all-star-misc">

	<supervisor-config
		name="all-star"
		label="All Star">

		<!-- conditions -->

		<value-condition
			name="sliceCode">

			<item value="psychic"/>

		</value-condition>

		<!-- aggregators -->

		<sum-stats-aggregator
			name="sum"/>

		<!-- data sets -->

		<data-set
			name="queueItemByUser"
			provider="queueItemUserStatsProvider"/>

		<data-set
			name="queueItemByQueue"
			provider="queueItemQueueStatsProvider"/>

		<!-- groupers -->

		<queue-stats-grouper
			name="queue"/>

		<user-stats-grouper
			name="user"/>

		<!-- formatters -->

		<integer-stats-formatter
			name="integer"/>

		<integer-stats-formatter
			name="userQueueItems"
			target-base="queue.supervisorItems">

			<target-param
				name="userId"
				value="{group}"/>

			<target-param
				name="interval"
				value="{interval}"/>

		</integer-stats-formatter>

		<!-- resolvers -->

		<!-- per queue -->

		<simple-stats-resolver
			name="queueNumProcessed"
			aggregator="sum"
			data-set="queueItemByQueue"
			index="queueId"
			value="numProcessed"/>

		<!-- per user -->

		<simple-stats-resolver
			name="userNumProcessed"
			aggregator="sum"
			data-set="queueItemByUser"
			index="userId"
			value="numProcessed"/>

		<!-- totals -->

		<simple-stats-resolver
			name="totalCreated"
			aggregator="sum"
			data-set="queueItemByQueue"
			value="numCreated"/>

		<simple-stats-resolver
			name="totalProcessed"
			aggregator="sum"
			data-set="queueItemByUser"
			value="numProcessed"/>

		<addition-stats-resolver
			name="totalDifference">
			<operand resolver="totalCreated"/>
			<operand resolver="totalProcessed" coefficient="-1"/>
		</addition-stats-resolver>

		<simple-stats-resolver
			name="totalPreferred"
			aggregator="sum"
			data-set="queueItemByQueue"
			value="numPreferred"/>

		<multiplication-stats-resolver
			name="totalPreferredPercent">
			<operand value="100"/>
			<operand resolver="totalPreferred"/>
			<operand resolver="totalProcessed" power="-1"/>
		</multiplication-stats-resolver>

		<!-- content -->

		<table>

			<heading
				group-label="Queue"/>

			<stats-group
				grouper="queue"
				resolver="queueNumProcessed"
				formatter="integer"/>

			<separator/>

			<heading
				group-label="User"/>

			<stats-group
				grouper="user"
				resolver="userNumProcessed"
				formatter="userQueueItems"/>

			<separator/>

			<heading
				group-label="Totals"/>

			<stats-total
				label="Total in"
				resolver="totalCreated"
				formatter="integer"/>

			<stats-total
				label="Total out"
				resolver="totalProcessed"
				formatter="integer"/>

			<stats-total
				label="Difference"
				resolver="totalDifference"
				formatter="integer"/>

			<stats-total
				label="Preferred %"
				resolver="totalPreferredPercent"
				formatter="integer"/>

		</table>

	</supervisor-config>

</console-module>