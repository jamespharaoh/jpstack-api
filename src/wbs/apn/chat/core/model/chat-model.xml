<model-meta
	name="chat"
	type="major">

	<fields>

		<!-- id -->

		<generated-id-field/>

		<!-- identity -->

		<parent-field
			type="slice"/>

		<code-field/>

		<!-- details -->

		<name-field/>

		<description-field/>

		<deleted-field/>

		<!-- settings -->

		<integer-field
			name="timeLogoff"
			default="0"/>

		<integer-field
			name="timeSend"
			default="0"/>

		<integer-field
			name="timeReceive"
			default="0"/>

		<integer-field
			name="timeInfo"
			default="0"/>

		<integer-field
			name="timeWebLogoff"
			default="0"/>

		<integer-field
			name="timeName"
			default="0"/>

		<integer-field
			name="timeNameJoin"
			default="0"/>

		<integer-field
			name="timePicHint"
			default="0"/>

		<integer-field
			name="timeJoinOutboundMin"
			default="0"/>

		<integer-field
			name="timeJoinOutboundMax"
			default="0"/>

		<integer-field
			name="timeQuietOutbound"
			default="0"/>

		<integer-field
			name="timeSignupTimeout"
			default="0"/>

		<yes-no-field
			name="autoAdultVerify"
			default="no"/>

		<enum-field
			type="gender"
			nullable="yes"/>

		<enum-field
			type="orient"
			nullable="yes"/>

		<yes-no-field
			name="autoJoinChat"
			default="no"/>

		<yes-no-field
			name="autoJoinDate"
			default="no"/>

		<yes-no-field
			name="autoJoinOnSend"
			default="no"/>

		<reference-field
			type="numberFormat"
			nullable="yes"/>

		<reference-field
			type="currency"
			nullable="yes"/>

		<reference-field
			type="gazetteer"
			nullable="yes"/>

		<string-field
			name="defaultBrandName"
			default="Chat service"/>

		<string-field
			name="timezone"
			nullable="yes"/>

		<integer-field
			name="timeMonitorSwap"
			default="0"/>

		<reference-field
			type="locator"
			nullable="yes"/>

		<string-field
			name="jigsawApplicationIdentifier"
			nullable="yes"/>

		<integer-field
			name="minMonitorMessageLength"
			default="80"/>

		<reference-field
			name="systemChatUser"
			type="chatUser"
			nullable="yes"/>

		<integer-field
			name="maxAlarmTime"
			default="0"/>

		<integer-field
			name="sessionInfoLimit"
			nullable="yes"/>

		<reference-field
			name="adultAdsChat"
			type="chat"
			nullable="yes"/>

		<integer-field
			name="adultAdsTime"
			default="0"/>

		<yes-no-field
			name="datingEnabled"
			default="yes"/>

		<yes-no-field
			name="joinWarningEnabled"
			default="no"/>

		<yes-no-field
			name="errorOnUnrecognised"
			default="no"/>

		<yes-no-field
			name="sendWarningFromShortcode"
			default="no"/>

		<yes-no-field
			name="sendDobRequestFromShortcode"
			default="no"/>

		<yes-no-field
			name="billDuringJoin"
			default="no"/>

		<yes-no-field
			name="confirmCharges"
			default="yes"/>

		<integer-field
			name="adTimeFirst"
			default="0"/>

		<integer-field
			name="adTime"
			default="0"/>

		<integer-field
			name="adCount"
			default="0"/>

		<yes-no-field
			name="billBlockedUsers"
			default="no"/>

		<integer-field
			name="billTimeLimit"
			default="0"/>

		<!-- queue preferred times -->

		<integer-field
			name="chatQueuePreferredTime"
			default="0"/>

		<integer-field
			name="messageQueuePreferredTime"
			default="0"/>

		<integer-field
			name="helpQueuePreferredTime"
			default="0"/>

		<integer-field
			name="infoQueuePreferredTime"
			default="0"/>

		<!-- statistics -->

		<timestamp-field
			name="lastMonitorSwap"
			column-type="postgresql"
			nullable="yes"/>

		<integer-field
			name="numChatBroadcastScheduled"
			default="0"/>

		<integer-field
			name="numChatBroadcastSending"
			default="0"/>

		<integer-field
			name="numChatBroadcastSent"
			default="0"/>

		/*
		@ReferenceField (nullable = true)
		TicketManagerRec ticketManager;
		*/

	</fields>

	<collections>

		<children-mapping
			name="keywords"
			type="chatKeyword"
			map-column="keyword"
			map-type="string"
			order-sql="keyword"/>

		<children-collection
			type="chatScheme"
			order-sql="code"/>

		<children-collection
			type="chatHelpTemplate"
			order-sql="code"/>

		<children-collection
			type="chatAdTemplate"/>

		<children-mapping
			name="profileFields"
			type="chatProfileField"
			map-column="code"
			map-type="string"/>

		<children-mapping
			type="chatRoute"
			map-column="route_id"
			map-type="integer"/>

	</collections>

	<priv-types>

		<priv-type
			name="Manage"
			description="Full control of an SMS chat service"
			template="yes"/>

		<priv-type
			name="Messages"
			description="View message history for an SMS chat service"
			template="yes"/>

		<priv-type
			name="Stats"
			description="View message statistics for an SMS chat service"
			template="yes"/>

		<priv-type
			name="Supervisor"
			description="View supervisor reports for an SMS chat service"
			template="yes"/>

		<priv-type
			name="Broadcast"
			description="Send and manage broadcasts for an SMS chat service"
			template="yes"/>

	</priv-types>

	<command-types>

		<command-type
			name="Check credit"
			description="Request the current credit balance for a user of an SMS chat service"/>

		<command-type
			name="Image upload"
			description="Request a URL to upload a new image for a user of an SMS chat service"/>

	</command-types>

	<service-types>

		<service-type
			name="Bill"
			description="Billed messages for an SMS chat service"/>

		<service-type
			name="Broadcast"
			description="Broadcast messages for an SMS chat service"/>

		<service-type
			name="System"
			description="System messages for an SMS chat service"/>

	</service-types>

	<background-processes>

		<background-process
			object-type="chat"
			name="Monitor swap"
			description="Swap online monitor users"
			frequency="10 seconds"/>

	</background-processes>

	<batch-types>

		<batch-type
			name="Broadcast"
			batch="chatBroadcast"
			description="A single broadcast to an SMS chat service"/>

	</batch-types>

	<delivery-types>

		<delivery-type
			name="Chat bill"
			description="Billed message for an SMS chat service"/>

		<delivery-type
			name="Chat bill strict"
			description="Strict billed message for an SMS chat service"/>

		<delivery-type
			name="Chat adult"
			description="Adult verification for an SMS chat service"/>

		<delivery-type
			name="Chat adult join"
			description="Adult verification and join for an SMS chat service"/>

	</delivery-types>

	<number-lookup-types>

		<number-lookup-type
			name="Block all"
			description="Numbers of SMS chat service users who are fully blocked"/>

	</number-lookup-types>

	<queue-types>

		<queue-type
			name="Help"
			description="Pending help messages from users of a chat service"
			subject="chatUser"
			ref="chatHelpLog"
			preferred-user-delay="helpQueuePreferredTime"
			supervisor-priv="this:supervisor"
			default-priority="-10"/>

		<queue-type
			name="Chat gay female"
			description="Pending messages to a chat service monitor"
			subject="chatUser"
			ref="chatMonitorInbox"
			preferred-user-delay="chatQueuePreferredTime"
			supervisor-priv="this:supervisor"/>

		<queue-type
			name="Chat gay female alarm"
			description="Pending alarm for a chat service monitor"
			subject="chatUser"
			ref="chatMonitorInbox"
			preferred-user-delay="messageQueuePreferredTime"
			supervisor-priv="this:supervisor"/>

		<queue-type
			name="Chat gay male"
			description="Pending messages to a chat service monitor"
			subject="chatUser"
			ref="chatMonitorInbox"
			preferred-user-delay="chatQueuePreferredTime"
			supervisor-priv="this:supervisor"/>

		<queue-type
			name="Chat gay male alarm"
			description="Pending alarm for a chat service monitor"
			subject="chatUser"
			ref="chatMonitorInbox"
			preferred-user-delay="chatQueuePreferredTime"
			supervisor-priv="this:supervisor"/>

		<queue-type
			name="Chat straight female"
			description="Pending messages to a chat service monitor"
			subject="chatUser"
			ref="chatMonitorInbox"
			preferred-user-delay="chatQueuePreferredTime"
			supervisor-priv="this:supervisor"/>

		<queue-type
			name="Chat straight female alarm"
			description="Pending alarm for a chat service monitor"
			subject="chatUser"
			ref="chatMonitorInbox"
			preferred-user-delay="chatQueuePreferredTime"
			supervisor-priv="this:supervisor"/>

		<queue-type
			name="Chat straight male"
			description="Pending messages to a chat service monitor"
			subject="chatUser"
			ref="chatMonitorInbox"
			preferred-user-delay="chatQueuePreferredTime"
			supervisor-priv="this:supervisor"/>

		<queue-type
			name="Chat straight male alarm"
			description="Pending alarm for a chat service monitor"
			subject="chatUser"
			ref="chatMonitorInbox"
			preferred-user-delay="chatQueuePreferredTime"
			supervisor-priv="this:supervisor"/>

		<queue-type
			name="Chat unknown"
			description="Pending messages to a chat service monitor"
			subject="chatUser"
			ref="chatMonitorInbox"
			preferred-user-delay="chatQueuePreferredTime"
			supervisor-priv="this:supervisor"/>

		<queue-type
			name="Chat unknown alarm"
			description="Pending alarm for a chat service monitor"
			subject="chatUser"
			ref="chatMonitorInbox"
			preferred-user-delay="chatQueuePreferredTime"
			supervisor-priv="this:supervisor"/>

		<queue-type
			name="Message"
			description="User-to-user chat service message pending approval"
			subject="chatUser"
			ref="chatMessage"
			preferred-user-delay="messageQueuePreferredTime"
			supervisor-priv="this:supervisor"
			default-priority="-10"/>

		<queue-type
			name="User"
			description="Chat service user profile pending approval"
			subject="chatUser"
			ref="chatUser"
			preferred-user-delay="infoQueuePreferredTime"
			supervisor-priv="this:supervisor"
			default-priority="-5"/>

	</queue-types>

</model-meta>
