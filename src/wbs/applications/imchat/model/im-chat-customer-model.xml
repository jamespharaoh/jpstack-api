<model-meta
	name="imChatCustomer"
	type="common">

	<fields>

		<!-- id -->

		<generated-id-field/>

		<!-- identity -->

		<parent-field
			type="imChat"/>

		<code-field/>

		<!-- settings -->

		<string-field
			name="email"/>

		<string-field
			name="password"/>

		<yes-no-field
			name="acceptedTermsAndConditions"
			default="no"/>

		<yes-no-field
			name="detailsCompleted"
			default="no"/>

		<!-- statistics -->

		<integer-field
			name="numConversations"
			default="0"/>

		<integer-field
			name="numPurchases"
			default="0"/>

		<integer-field
			name="balance"
			default="0"/>

		<!-- data -->

		<reference-field
			name="currentConversation"
			type="imChatConversation"
			nullable="yes"/>

		<reference-field
			name="activeSession"
			type="imChatSession"
			nullable="yes"/>

	</fields>

	<collections>

		<children-list
			name="purchases"
			type="imChatPurchase"/>

		<children-mapping
			name="details"
			type="imChatCustomerDetailValue"
			map-type="integer"
			map-column="im_chat_customer_detail_type_id"/>

	</collections>

	<event-types>

		<event-type
			name="IM chat customer conditions accepted"
			text="%0 accepted terms and conditions"
			admin="no"/>

		<event-type
			name="IM chat customer detail updated"
			text="%0 set value for %1 to %2"
			admin="no"/>

	</event-types>

</model-meta>